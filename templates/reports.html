{% extends "layout.html" %}

{% block content %}
<div class="page-header">
    <h1><i class="fas fa-chart-bar"></i> Reports & Analytics</h1>
</div>

<!-- Worker Productivity Report -->
<div class="card">
    <div class="card-header">
        <h3><i class="fas fa-users"></i> Worker Productivity Report</h3>
        <div class="card-actions">
            <button class="btn btn--secondary" onclick="exportToExcel('worker_productivity')">
                <i class="fas fa-download"></i> Export Excel
            </button>
        </div>
    </div>
    <div class="card-body">
        {% if worker_stats %}
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Worker Name</th>
                        <th>Department</th>
                        <th>Total Pieces</th>
                        <th>Total Earnings (â‚¹)</th>
                        <th>Avg Pieces/Day</th>
                        <th>Efficiency</th>
                    </tr>
                </thead>
                <tbody>
                    {% for worker in worker_stats %}
                    <tr>
                        <td><strong>{{ worker.name }}</strong></td>
                        <td>{{ worker.department }}</td>
                        <td class="text-primary">{{ worker.total_pieces or 0 }}</td>
                        <td class="text-success">{{ "%.2f"|format(worker.total_earnings or 0) }}</td>
                        <td>{{ "%.1f"|format((worker.total_pieces or 0) / 7) }}</td>
                        <td>
                            {% set efficiency = ((worker.total_pieces or 0) / 100) * 100 %}
                            <div class="efficiency-bar">
                                <div class="efficiency-fill" style="width: {{ efficiency if efficiency <= 100 else 100 }}%"></div>
                                <span>{{ "%.1f"|format(efficiency) }}%</span>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <i class="fas fa-chart-bar"></i>
            <h4>No Data Available</h4>
            <p>Worker productivity data will appear here once production starts.</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Export Options -->
<div class="card">
    <div class="card-header">
        <h3><i class="fas fa-download"></i> Data Export</h3>
    </div>
    <div class="card-body">
        <div class="export-options">
            <button class="btn btn--secondary" onclick="exportToExcel('workers')">
                <i class="fas fa-users"></i> Export Workers Data
            </button>
            <button class="btn btn--secondary" onclick="exportToExcel('bundles')">
                <i class="fas fa-boxes"></i> Export Bundles Data
            </button>
            <button class="btn btn--secondary" onclick="exportToExcel('production')">
                <i class="fas fa-chart-line"></i> Export Production Data
            </button>
            <button class="btn btn--secondary" onclick="exportToExcel('earnings')">
                <i class="fas fa-rupee-sign"></i> Export Earnings Report
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function exportToExcel(type) {
    alert(`Exporting ${type} data to Excel...`);
    // In a real implementation, this would download a file
    // window.location.href = `/export/${type}?format=excel`;
}
</script>
{% endblock %}