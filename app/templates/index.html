<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Management System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>PMS</h2>
            <button class="sidebar-toggle" id="sidebarToggle">‚ò∞</button>
        </div>
        <ul class="nav-links">
            <li><a href="#dashboard" class="nav-link active" data-section="dashboard">üìä Dashboard</a></li>
            <li><a href="#workers" class="nav-link" data-section="workers">üë• Workers</a></li>
            <li><a href="#operations" class="nav-link" data-section="operations">‚öôÔ∏è Operations</a></li>
            <li><a href="#bundles" class="nav-link" data-section="bundles">üì¶ Bundles</a></li>
            <li><a href="#production-order" class="nav-link" data-section="production-order">üìã Production Order</a></li>
            <li><a href="#file-upload" class="nav-link" data-section="file-upload">üìÅ File Upload</a></li>
            <li><a href="#esp32-demo" class="nav-link" data-section="esp32-demo">üì± ESP32 Scanner</a></li>
            <li><a href="#reports" class="nav-link" data-section="reports">üìà Reports</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="section-header">
                <h1>Production Dashboard</h1>
                <div class="header-actions">
                    <button class="btn btn--primary" id="refreshData">üîÑ Refresh</button>
                    <span class="last-update">Last updated: <span id="lastUpdate">--:--</span></span>
                </div>
            </div>

            <!-- Statistics Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-content">
                        <h3 id="activeWorkers">8</h3>
                        <p>Active Workers</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üì¶</div>
                    <div class="stat-content">
                        <h3 id="totalBundles">12</h3>
                        <p>Total Bundles</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚öôÔ∏è</div>
                    <div class="stat-content">
                        <h3 id="totalOperations">136</h3>
                        <p>Operations</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <h3 id="totalEarnings">‚Çπ205.92</h3>
                        <p>Total Earnings</p>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="charts-grid">
                <div class="card">
                    <div class="card__body">
                        <h3>Bundle Status Distribution</h3>
                        <div class="chart-container" style="position: relative; height: 300px;">
                            <canvas id="bundleStatusChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card__body">
                        <h3>Department Workload</h3>
                        <div class="chart-container" style="position: relative; height: 300px;">
                            <canvas id="departmentChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity Feed -->
            <div class="card">
                <div class="card__header">
                    <h3>Recent Activity</h3>
                </div>
                <div class="card__body">
                    <div class="activity-feed" id="activityFeed"></div>
                </div>
            </div>
        </section>

        <!-- Workers Section -->
        <section id="workers" class="section">
            <div class="section-header">
                <h1>Worker Management</h1>
                <button class="btn btn--primary" id="addWorkerBtn">+ Add Worker</button>
            </div>

            <div class="card">
                <div class="card__body">
                    <div class="table-controls">
                        <input type="text" class="form-control" id="workerSearch" placeholder="Search workers...">
                        <select class="form-control" id="departmentFilter">
                            <option value="">All Departments</option>
                            <option value="SLEEVE">SLEEVE</option>
                            <option value="COLLAR">COLLAR</option>
                            <option value="LINING">LINING</option>
                            <option value="BODY">BODY</option>
                            <option value="ASSE-1">ASSE-1</option>
                            <option value="ASSE-2">ASSE-2</option>
                            <option value="FLAP">FLAP</option>
                            <option value="BACK">BACK</option>
                        </select>
                    </div>
                    <div class="table-container">
                        <table id="workersTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Token ID</th>
                                    <th>Department</th>
                                    <th>Line</th>
                                    <th>Status</th>
                                    <th>QR Code</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="workersTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Operations Section -->
        <section id="operations" class="section">
            <div class="section-header">
                <h1>Operations Management</h1>
                <div class="header-actions">
                    <select class="form-control" id="operationsFilter">
                        <option value="">All Departments</option>
                        <option value="SLEEVE">SLEEVE</option>
                        <option value="COLLAR">COLLAR</option>
                        <option value="LINING">LINING</option>
                        <option value="BODY">BODY</option>
                        <option value="ASSE-1">ASSE-1</option>
                        <option value="ASSE-2">ASSE-2</option>
                        <option value="FLAP">FLAP</option>
                        <option value="BACK">BACK</option>
                        <option value="POST ASSEMBLY">POST ASSEMBLY</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <div class="card__body">
                    <div class="table-container">
                        <table id="operationsTable">
                            <thead>
                                <tr>
                                    <th>Seq No</th>
                                    <th>Op No</th>
                                    <th>Description</th>
                                    <th>Machine</th>
                                    <th>Department</th>
                                    <th>Std Min</th>
                                    <th>Piece Rate (‚Çπ)</th>
                                </tr>
                            </thead>
                            <tbody id="operationsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Bundles Section -->
        <section id="bundles" class="section">
            <div class="section-header">
                <h1>Bundle Management</h1>
                <button class="btn btn--primary" id="assignBundleBtn">Assign Bundle</button>
            </div>
            <div class="bundles-grid" id="bundlesGrid"></div>
        </section>

        <!-- Production Order Section -->
        <section id="production-order" class="section">
            <div class="section-header"><h1>Production Order Details</h1></div>
            <div class="card">
                <div class="card__header"><h3>Order Information</h3></div>
                <div class="card__body">
                    <div class="order-details">
                        <div class="detail-row"><strong>Order No:</strong> <span id="orderNo">650010011410</span></div>
                        <div class="detail-row"><strong>Style:</strong> <span id="styleName">SAINTX MENS BLAZER</span></div>
                        <div class="detail-row"><strong>Total Quantity:</strong> <span id="totalQty">1,119</span></div>
                        <div class="detail-row"><strong>Buyer:</strong> <span id="buyerName">BANSWARA GARMENTS A UNIT OF BANSWAR</span></div>
                    </div>
                    <h4>Color Distribution</h4>
                    <div class="color-distribution" id="colorDistribution"></div>
                </div>
            </div>
        </section>

        <!-- File Upload Section -->
        <section id="file-upload" class="section">
            <div class="section-header"><h1>File Upload</h1></div>
            <div class="upload-grid">
                <div class="card">
                    <div class="card__header"><h3>Upload OB File (Excel)</h3></div>
                    <div class="card__body">
                        <div class="upload-area" id="obUploadArea">
                            <div class="upload-content">
                                <div class="upload-icon">üìÑ</div>
                                <p>Drop Excel file here or click to browse</p>
                                <input type="file" id="obFileInput" accept=".xlsx,.xls" hidden>
                            </div>
                        </div>
                        <div class="upload-status" id="obUploadStatus"></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card__header"><h3>Upload Production Order</h3></div>
                    <div class="card__body">
                        <div class="upload-area" id="poUploadArea">
                            <div class="upload-content">
                                <div class="upload-icon">üìã</div>
                                <p>Drop PDF file here or click to browse</p>
                                <input type="file" id="poFileInput" accept=".pdf" hidden>
                            </div>
                        </div>
                        <div class="upload-status" id="poUploadStatus"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ESP32 Demo Section -->
        <section id="esp32-demo" class="section">
            <div class="section-header"><h1>ESP32 Scanner Demo</h1></div>
            <div class="scanner-grid">
                <div class="card">
                    <div class="card__header"><h3>Scanner Interface</h3></div>
                    <div class="card__body">
                        <div class="scanner-display">
                            <div class="scanner-screen">
                                <div class="scan-area">
                                    <div class="scan-line"></div>
                                    <p id="scanStatus">Ready to scan...</p>
                                </div>
                            </div>
                            <div class="scanner-controls">
                                <button class="btn btn--primary" id="simulateScanBtn">Simulate Scan</button>
                                <button class="btn btn--secondary" id="resetScannerBtn">Reset</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card__header"><h3>Scan Log</h3></div>
                    <div class="card__body">
                        <div class="scan-log" id="scanLog"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="section">
            <div class="section-header">
                <h1>Reports & Analytics</h1>
                <button class="btn btn--primary" id="exportReportBtn">üì• Export Report</button>
            </div>
            <div class="reports-grid">
                <div class="card">
                    <div class="card__body">
                        <h3>Worker Productivity</h3>
                        <div class="chart-container" style="position: relative; height: 300px;">
                            <canvas id="productivityChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card__body">
                        <h3>Earnings Summary</h3>
                        <div class="earnings-summary" id="earningsSummary"></div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <div class="modal hidden" id="addWorkerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Worker</h3>
                <button class="modal-close" id="closeAddWorkerModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addWorkerForm">
                    <div class="form-group">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" id="workerName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Token ID</label>
                        <input type="text" class="form-control" id="workerToken" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Department</label>
                        <select class="form-control" id="workerDepartment" required>
                            <option value="">Select Department</option>
                            <option value="SLEEVE">SLEEVE</option>
                            <option value="COLLAR">COLLAR</option>
                            <option value="LINING">LINING</option>
                            <option value="BODY">BODY</option>
                            <option value="ASSE-1">ASSE-1</option>
                            <option value="ASSE-2">ASSE-2</option>
                            <option value="FLAP">FLAP</option>
                            <option value="BACK">BACK</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Line</label>
                        <select class="form-control" id="workerLine" required>
                            <option value="">Select Line</option>
                            <option value="Line-1">Line-1</option>
                            <option value="Line-2">Line-2</option>
                            <option value="Line-3">Line-3</option>
                            <option value="Line-4">Line-4</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" id="cancelAddWorker">Cancel</button>
                        <button type="submit" class="btn btn--primary">Add Worker</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal hidden" id="qrCodeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Worker QR Code</h3>
                <button class="modal-close" id="closeQrModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="qr-display">
                    <div id="qrCodeContainer"></div>
                    <p id="qrWorkerInfo"></p>
                    <button class="btn btn--primary" id="downloadQrBtn">Download QR Code</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal hidden" id="assignBundleModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Assign Bundle to Worker</h3>
                <button class="modal-close" id="closeAssignModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="assignBundleForm">
                    <div class="form-group">
                        <label class="form-label">Bundle</label>
                        <select class="form-control" id="bundleSelect" required></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Worker</label>
                        <select class="form-control" id="workerSelect" required></select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Operation</label>
                        <select class="form-control" id="operationSelect" required></select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn btn--secondary" id="cancelAssign">Cancel</button>
                        <button type="submit" class="btn btn--primary">Assign Bundle</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <script src="app.js"></script>
</body>
</html>
