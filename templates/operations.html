{% extends "base.html" %}
{% block content %}
<h1>Operations (OB)</h1>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="mt-3">
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<form method="post" class="row g-2 mb-3">
  <div class="col-md-2">
    <input class="form-control" name="op_no" placeholder="Op No (e.g. 5077)" required>
  </div>
  <div class="col-md-4">
    <input class="form-control" name="description" placeholder="Description">
  </div>
  <div class="col-md-3">
    <input class="form-control" name="section" placeholder="Section">
  </div>
  <div class="col-md-2">
    <input class="form-control" name="std_min" type="number" step="0.01" placeholder="Std Min">
  </div>
  <div class="col-md-1">
    <button class="btn btn-primary w-100" type="submit">Add</button>
  </div>
</form>

<table class="table table-bordered table-striped table-sm">
  <thead>
    <tr>
      <th>Op No</th>
      <th>Description</th>
      <th>Section</th>
      <th>Std Min</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for o in operations %}
    <tr>
      <td>{{ o.op_no }}</td>
      <td>{{ o.description or '' }}</td>
      <td>{{ o.section or '' }}</td>
      <td>{{ '%.2f' % o.std_min }}</td>
      <td>
        <form action="{{ url_for('operations_delete', oid=o.id) }}" method="post" onsubmit="return confirm('Delete operation {{ o.op_no }}?')">
          <button class="btn btn-sm btn-danger">Delete</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
